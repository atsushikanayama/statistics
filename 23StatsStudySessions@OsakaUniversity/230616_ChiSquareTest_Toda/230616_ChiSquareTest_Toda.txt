χ2検定勉強会 2023/06/16M2戸田梨鈴パラメトリックとノンパラメトリック χ2検定1変量のχ 2検定（適合度の検定）2変量のχ 2検定（独立性の検定）マクネマー検定（対応のあるデータ）パラメトリックとノンパラメトリックlパラメトリック：parameter（母数）に基づくデータを想定して行う分析＝特定の分布（≒正規分布）を仮定する分析 Ø比率尺度：ゼロを基準に、間隔や比率に意味があるもの（e.g.,身長） Ø間隔尺度：目盛りが等間隔で、間隔に意味があるもの（e.g.,気温）量的データ lノンパラメトリック：特定の分布を仮定しない Ø名義尺度：他と区別し分類するためのもの（e.g.,性別） Ø順序尺度：順序や大小には意味があるが、間隔には意味がないもの（e.g.,順位）質的データ Øサンプル数が小さい … 正しく分布曲線を描けない Ø外れ値がある … 分布曲線が歪むhttps://bellcurve.jp/statistics/course/1562.html / https://www.study-channel.com/2015/06/parametric-nonparametric-test.html χ2検定• χ2検定(ch i-squaretest)： χ2分布を利用する分析 • χ2分布：各データの２乗の和 (=χ 2値) が従う分布➡自由度によってグラフの形が変わる➡自由度が大きくなると正規分布に近づくl【補足】自由度df：代表値や合計値がある時に自由に決められる数Ø実際のデータを表すものではなくデータの特徴を示す • m xnのクロス集計表では (m-1)x(n-1)  実験群 統制群 合計  ○ 15 10 25  ×5 10 15  合計202040  4  https://service.nikkei-r.co.jp/glossary/chi-square-test/ テキスト「⼊⾨統計学」/ https://best-biostatistics.com/contingency/degree-freedom.html 1変量のχ 2検定（適合度の検定）l1変量のχ 2検定（適合度の検定）：得られたデータが特定の分布（理論値）に適合しているか Øある質問に対して、5名が「はい」15名が「いいえ」と答えたこの時、「はい」より「いいえ」の人の方が有意に多いと言えるか？ ➡理論値（はい50%,いいえ50%）に適合していない？（ p<.05 =理論値とは適合していない） l使う関数 Øfactor( )：順序なし因子（名義尺度の形式）に変換 Østr() :データフレームの中身を表示（← RStud io 右上でも確認できる） • labels=c(‘ラベル名1’,‘ラベル名2 ’,…)：ラベルをつける（元のデータが小さい順に） • table( )：要素ごとの数を数えて、カテゴリ別に表にする Øchisq.test( )：χ 2検定 Øpie( )：円グラフの作成1変量のχ 2検定（適合度の検定） l理論値を指定して適合度の検定を行う場合 Ø日本人の血液型の分布はA型が40%、O型が30%、B型が20%、AB型が10%であるとされる。今回得られた100人のデータは、この日本人の血液型分布と同じと言えるか？• chisq.test( )で期待値を指定p=c( )で直接入力することができる※ 合計が1になる割合の形で入力するhttps://bellcurve.jp/statistics/course/9494.html 2変量のχ 2検定（独立性の検定） l2変量のχ 2検定（独立性の検定）：各要因は互いに独立している（関係がない）か Øある質問を男子20名、女子20名に対して行った。この質問に対する回答の性別による違いは有意であると言えるか？➡ 2つの要因（回答＆性別）は独立でない？（ p<.05 =独立でない） l使う関数 • table( )：data$見出しで使用する列を指定できる • chisq.test( )：χ 2検定 • matrix( )：行列を作る、nrow= 行の数（縦）、ncol=列の数（横） Ørownames( )：行ラベル（上から順に入力） Øcolnames( )：列ラベル（左から順に入力）2変量のχ 2検定（独立性の検定）l独立性の検定の注意点：χ 2値をχ 2分布に当てはめて得られる近似した確率➡データ数が少ないと正しい値が求められない ➡フィッシャーの直接確率検定（F isher‘s exact test） Ø度数が0のセルがある Ø度数が5以下のセルが、セル全体の20%以上 Ø周辺度数に10以下のものがある Øﬁsher.test( )：フィッシャーの直接確率検定l使う関数 マクネマー検定（対応のあるデータ） lマクネマー検定：対応のある２値データについて、2つの結果に差があるか➡被験者内要因、介入前後の比較など Ø子どもに「ゆるす」「ゆるさない」の2種類のストーリーを読み聞かせた。各ストーリーにおいて、主人公は違反者と「一緒に遊ぶ」「別々に遊ぶ」のどちらだと思うか尋ねた。ストーリーによって、児の選択が変わったと言えるか？ l使う関数 Ømcnemar.test( )：マクネマー検定 • correct=：イェーツの補正、サンプル数が小さい時は補正を行う（=T）練習問題lある幼稚園で、子ども200名（男児 100名、女児 100名）に3種類のおもちゃ（A, B, C）の中からどれで一番遊びたいかを選択させた。 Øこの質問に対する回答と児の性別に有意な関連は見られるか？ ①データの読み込み（データ： chap4practice.csv） ②データ型の確認 ③表の作成（※ csvファイルには ID, gender, choiceについてのデータが含まれています） ④検定手法の選択※ 実際にはこの後に多重比較が必要