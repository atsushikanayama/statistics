---
title: "Rの基礎 by 田辺和奏"
author: "金山篤志"
date: "2023-06-09"
output: 
  html_document:
    toc: true
    toc_float: true
    theme: cosmo
---

# RStudioの基本について学ぶ

Rのコマンドの実行、オブジェクト（Object、Rで扱うデータのまとまりや関数など）の確認、さまざまな種類のファイルの読み書きについて学びます。

## Rコマンドの実行

str関数はR言語の非常に便利な関数で、指定したオブジェクト（変数、データフレーム、リストなど）の構造や属性を調べるために使用されます。これは、データの全体像を掴み、それがどのような形式で保存されているかを理解するための重要な手段です。

次の例では、Rが提供している標準データセットである'iris'データセットの構造を表示しています。この'iris'データセットは、アヤメの品種とその花弁やがくの長さ・幅などの情報を含んでいます。str(iris)の結果から、各列のデータ型（数値、文字列、因子など）、列の数、各列の最初の数行のデータなどを確認できます。

具体的には、以下のような情報が表示されます：

- データフレーム（data.frame）
- 全部で150の観測値（行）、5つの変数（列）
- 各列の名前（Sepal.Length, Sepal.Width, Petal.Length, Petal.Width, Species）とそれぞれのデータ型（数値、因子）
- 各列の最初の数行のデータ値

```{r}
# str関数でirisデータセットの構造を確認
str(iris)
```

次に、Rでのforループのシンプルな使用例を示します。このスクリプトは1から10までの数値に1を加えて出力します。

```{r}
# forループを用いて1から10までの数値に1を加える
for (i in 1:10) {
  print(i + 1)
}
```

## オブジェクトの作成と確認

Rを使用してオブジェクトを作成し、その内容を確認することができます。以下にいくつかの例を示します。

まず、irisデータセットを"d"という名前のオブジェクトに割り当てます。

```{r}
# irisデータセットをオブジェクトdに割り当てる
d <- iris
```

次に、行列（Matrix）、ベクトル（Vector）、データフレーム（Dataframe）を含むリスト"x"を作成します。

```{r}
# 行列、ベクトル、データフレームを含むリストxを作成する
x <- list(m = matrix(1:10, nrow = 2), v = 1:100, df = iris)
```

次に、数値かどうかをチェックしてそれらを足し合わせる"tashizan"という名前の関数を定義します。数値でない入力が与えられた場合、関数はエラーを出力します。

```{r}
# 数値かどうかをチェックして足し合わせる関数tashizanを定義
tashizan <- function(a, b) {
  if (!is.numeric(a) || !is.numeric(b)) {
    stop("数値を入力してください")
  }
  a + b
}
```

ここでは、forループを使用してRStudioのコード補完機能を紹介します。

```{r}
# forループを用いて1から10までの数値を出力
for (i in 1:10) {
  print(i)
}
```

この例では、RStudioのJobs機能を紹介しています。変数"x"を定義し、その結果には"jobs_demo_results"オブジェクトからアクセスできます。

```{r}
# 変数xを定義し、その結果をdata.frameオブジェクトに格納
x <- 1 + 1
jobs_demo_results <- data.frame(x = x)
print(jobs_demo_results$x)
```

# Rでのファイルの読み書き

このセクションでは、Rを使用してさまざまな種類のファイルを読み書きするプロセスについて詳しく説明します。これにはCSVファイル、Excelファイル、SAS、SPSS、STATAなどのデータファイルが含まれます。

## CSVファイルの読み書き

CSV（Comma-Separated Values）ファイルは、Rでよく使用されるデータ形式です。このコンマ区切りのテキストファイル形式では、各行がデータセットの1つの観測値を表し、各列が変数を示します。

irisデータをCSVファイルに書き込み、その後読み込む方法を見てみます。

```{r}
# irisデータをCSVファイルに書き込む
write.csv(iris, file = "iris.csv")

# 書き込んだCSVファイルを読み込む
data <- read.csv("iris.csv")
head(data)
```

## Excelファイルの読み書き

Excelファイルは、ビジネスや研究においても広く使用されており、Rでは便利なツールが提供されています。

readxlパッケージを使用してExcelファイルを読み込む方法を示します。このために、パッケージに含まれるサンプルデータを使用します。

```{r}
# readxlパッケージを読み込む
library(readxl)

# Excelファイルのパスを取得する
path <- system.file("extdata", "datasets.xlsx", package = "readxl")

# Excelファイルを読み込む
data <- read_excel(path)
head(data)
```

## SAS、SPSS、STATAファイルの読み書き

SAS、SPSS、STATAファイルは、社会科学や統計分析の分野でよく使用されます。今回はRのhavenパッケージを使用して、インターネットから直接これらのファイルを読み込む方法を説明します。以下にSASファイルを例に示します。

まず、havenパッケージをインストールして読み込む必要があります。havenパッケージは、SAS、SPSS、Stataといった統計ソフトウェアのデータファイルをRで読み込むためのパッケージです。

```{r}
# havenパッケージを読み込む
library(haven)

# SASファイルのパスを取得する
path <- system.file("examples", "iris.sas7bdat", package = "haven")

# SASファイルを読み込む
data <- read_sas(path)
head(data)
```

# RやRStudioで困ったときの対処法

Rの関数の詳細を知りたいとき、または使い方について学びたいときには、「?」または「help」関数を利用します。これらの関数は、Rの関数の説明や使い方を表示するためのツールです。

```{r}
?plot  # 'plot'関数の説明と使い方を表示します。
help(plot)  # 同様に、'help'関数も'plot'関数の説明と使い方を表示します。
```

Rのパッケージには、そのパッケージの使用方法を詳しく説明したチュートリアルが含まれていることがあります。これらのチュートリアルは「ビネット」（vignette）と呼ばれ、vignette関数を使って表示することができます。

```{r}
vignette("dplyr")  # 'dplyr'パッケージのビネット（チュートリアル）を開きます。
```

上記のコードは、"dplyr"パッケージのビネットを開く方法を示しています。これにより、"dplyr"パッケージの詳しい使用方法を理解することができます。
